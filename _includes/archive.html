{% for post in site.posts %}
    {% if post.next %}
        {% capture year %}{{ post.date | date: '%Y' }}{% endcapture %}
        {% capture next_year %}{{ post.next.date | date: '%Y' }}{% endcapture %}
        {% if year != next_year %}
            </ul>
            <h2>{{ post.date | date: '%Y' }}</h2>
            <ul>
        {% endif %}
    {% else %}
        <!-- latest/first post -->
        <h2>{{ post.date | date: '%Y' }}</h2>
        <ul>
    {% endif %}
    <li>
        <span>{{ post.date | date:"%b" }}</span>
        <a href="{{ post.url }}">{{ post.title }}</a>
    </li>
{% endfor %}
</ul>
